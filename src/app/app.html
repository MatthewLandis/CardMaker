<app-header></app-header>
<div class="cardContainer">
  <section id="card">
    <img src="assets/CardTemplates/{{template}}Template.png">
    <img src="assets/placeholderArt.jpg" [ngClass]="{
      cardArt: true, 
      cardArtPendulum: pendulumTemplate
      }">
    <button class="pendulumTemplateBtn" (click)="pendulumTemplate = !pendulumTemplate"
      title="Toggle Pendulum Template"></button>
    @if (pendulumTemplate) {
    <img src="assets/CardTemplates/PendulumTemplates/PendulumShade/Pendulum{{template}}.png" />
    <img src="assets/CardTemplates/PendulumTemplates/PendulumTemplate.png" />
    <input class="pendulumScale" style="left: 55px;" [(ngModel)]="pendulumScale" type="number">
    <input class="pendulumScale" style="left: 700px;" [(ngModel)]="pendulumScale" type="number">
    <textarea class="pendulumEffectText" [value]="pendulumEffectText" spellcheck="false"></textarea>
    }
    <img src="assets/attributes/{{attribute}}.png" alt="Attribute">
    <img [src]="`assets/levels/level${hoverLevel !== 0 ? hoverLevel : level}.png`"
      [style.opacity]="hoverLevel ? 0.5 : 1">

    <!-- Template -->
    <button class="templateBtn" (click)="templateDropdownVisible = !templateDropdownVisible"
      title="Change Template"></button>
    @if (templateDropdownVisible) {
    <div class="templateDropdownGrid">
      @for (i of templates; track $index) {
      @if (template !== i) {
      <button class="templateBtn{{i}}" (click)="selectTemplate(i)">{{i}}</button>
      }
      }
    </div>
    }
    <!-- Level -->
    <div class="levelBtns">
      @for (i of [1,2,3,4,5,6,7,8,9,10,11,12,13]; track $index) {
      <button class="levelBtn{{i}}" (mouseenter)="hoverLevel = i" (mouseleave)="hoverLevel = 0"
        (click)="level = i; hoverLevel = 0" title="Change Level">{{i}}</button>
      }
    </div>

    <!-- Attribute -->
    <button class="attributeDropdownBtn" (click)="attributeDropdownVisible = !attributeDropdownVisible"
      title="Change Attribute"></button>
    @if (attributeDropdownVisible) {
    <div class="attributeDropdownGrid">
      @for (i of attributes; track $index) {
      @if (attribute !== i) {
      <button class="attributeBtn{{i}}" (click)="selectAttribute(i)"></button>
      }
      }
    </div>
    }

    <!-- Name -->
    <input #nameInput class="name {{titleStyle}}" [(ngModel)]="title" (input)="adjustNameScale()" spellcheck="false"
      title="Name">
    <button class="nameDropdownBtn" (click)="toggleNameDropdown()" title="Name Style"></button>
    @if (nameDropdownVisible) {
    <div class="nameDropdownGrid">
      @for (i of nameStyles; track $index) {
      <button class="{{i}}" (click)="selectNameStyle(i)">{{i}}</button>

      }
    </div>
    }
    <!-- Monster Type -->
    <div class="type">
      <span class="bracket">[</span>
      <span (click)="togglePrimaryTypeDropdown()" style="cursor: pointer;">{{primaryType}}</span>
      @if(coreTypes.includes(coreType)) {
      <span class="slash">/</span>
      <span>{{coreType}}</span>
      }
      @if(pendulumTemplate){
      <span class="slash">/</span>
      <span>Pendulum</span>
      }
      @if(abilityType) {
      <span class="slash">/</span>
      <span>{{abilityType}}</span>
      }
      @if (lastType) {
      <span class="slash" (click)="abilityDropdown()" style="cursor: pointer;">/</span>
      <span>{{lastType}}</span>
      }
      <span class="bracket">]</span>
    </div>
    <!-- Monster Type Dropdowns -->
    @if (primaryTypeDropdownVisible) {
    <div class="primaryTypeDropdownGrid">
      @for (i of primaryTypes; track $index) {
      <button class="primaryTypeBtn" (click)="selectPrimaryType(i)">{{i}}</button>
      }
    </div>
    }
      @if (abilityDropdownVisible) {
    <div class="primaryTypeDropdownGrid">
      @for (i of abilityTypes; track $index) {
      <button class="primaryTypeBtn" (click)="selectAbilityType(i)">{{i}}</button>
      }
    </div>
    }


    <!-- Text -->
    <textarea class="effectText" [value]="effectText" spellcheck="false"></textarea>
    <input #valueAtkInput class="atk" [value]="atk" (input)="adjustValueAtkScale()" title="Attack">
    <input #valueDefInput class="def" [value]="def" (input)="adjustValueDefScale()" title="Defense">
  </section>
</div>
<button class="createButton" (click)="createCard()">Create Card</button>

<router-outlet></router-outlet>